{
  "comment": "",
  "cspec": "1.0",
  "deployments": {
    "kafkacodetest": {
      "artifact": {
        "description": {
          "builtin": false,
          "config": {
            "parameter": {},
            "resilience": 0,
            "resource": {
              "cert": {
                "certificate": "cluster.core/wildcard-vera-kumori-cloud"
              },
              "domain": {
                "domain": "vscode"
              },
              "kafkavolume": {
                "volume": {
                  "kind": "storage",
                  "size": 10,
                  "unit": "G"
                }
              },
              "zookeepervolume": {
                "volume": {
                  "kind": "storage",
                  "size": 2,
                  "unit": "G"
                }
              }
            },
            "scale": {
              "detail": {
                "codeserver": {
                  "hsize": 1
                },
                "kafka": {
                  "hsize": 1
                },
                "zookeeper": {
                  "hsize": 1
                }
              }
            }
          },
          "connector": {
            "inboundconnector": {
              "clients": [
                {
                  "channel": "csinbound.inbound",
                  "role": "self"
                }
              ],
              "kind": "lb",
              "servers": [
                {
                  "links": [
                    {
                      "channel": "web",
                      "role": "codeserver"
                    }
                  ],
                  "meta": [
                    {
                      "auto": {
                        "compRef": {
                          "domain": "kumori.examples",
                          "kind": "component",
                          "module": "calccache",
                          "name": "codeserver",
                          "version": [
                            3,
                            0,
                            7
                          ]
                        },
                        "roleName": "codeserver"
                      },
                      "user": {}
                    }
                  ]
                }
              ]
            },
            "kafkaconnector": {
              "clients": [
                {
                  "channel": "discover",
                  "role": "self"
                },
                {
                  "channel": "kafkaclient",
                  "role": "codeserver"
                }
              ],
              "kind": "lb",
              "servers": [
                {
                  "links": [
                    {
                      "channel": "advertised",
                      "role": "kafka"
                    }
                  ],
                  "meta": [
                    {
                      "auto": {
                        "compRef": {
                          "domain": "kumori.examples",
                          "kind": "component",
                          "module": "calccache",
                          "name": "kafka",
                          "version": [
                            3,
                            0,
                            7
                          ]
                        },
                        "roleName": "kafka"
                      },
                      "user": {}
                    }
                  ]
                }
              ]
            },
            "zookeeperconnector": {
              "clients": [
                {
                  "channel": "zookeeperclient",
                  "role": "kafka"
                }
              ],
              "kind": "lb",
              "servers": [
                {
                  "links": [
                    {
                      "channel": "zookeepermain",
                      "role": "zookeeper"
                    }
                  ],
                  "meta": [
                    {
                      "auto": {
                        "compRef": {
                          "domain": "kumori.examples",
                          "kind": "component",
                          "module": "calccache",
                          "name": "zookeeper",
                          "version": [
                            3,
                            0,
                            7
                          ]
                        },
                        "roleName": "zookeeper"
                      },
                      "user": {}
                    }
                  ]
                }
              ]
            }
          },
          "role": {
            "codeserver": {
              "artifact": {
                "description": {
                  "builtin": false,
                  "code": {
                    "codeserver": {
                      "cmd": [
                        "--auth",
                        "none",
                        "--bind-addr",
                        "0.0.0.0:8080"
                      ],
                      "image": {
                        "hub": {
                          "name": "",
                          "secret": ""
                        },
                        "tag": "codercom/code-server"
                      },
                      "mapping": {
                        "env": {},
                        "filesystem": {}
                      },
                      "name": "codeserver",
                      "size": {
                        "cpu": {
                          "kind": "cpu",
                          "size": 2000,
                          "unit": "m"
                        },
                        "memory": {
                          "kind": "ram",
                          "size": 1,
                          "unit": "G"
                        },
                        "mincpu": 1000
                      },
                      "user": {
                        "groupid": 0,
                        "userid": 0
                      }
                    }
                  },
                  "config": {
                    "parameter": {},
                    "resilience": 0,
                    "resource": {},
                    "scale": {
                      "hsize": 1
                    }
                  },
                  "probe": {},
                  "profile": {
                    "iopsintensive": false,
                    "threadability": "*"
                  },
                  "size": {
                    "bandwidth": {
                      "kind": "bandwidth",
                      "size": 1000,
                      "unit": "M"
                    },
                    "minbandwidth": 1000,
                    "mincpu": {
                      "kind": "cpu",
                      "size": 1000,
                      "unit": "m"
                    }
                  },
                  "srv": {
                    "client": {
                      "kafkaclient": {
                        "inherited": false,
                        "protocol": "http"
                      }
                    },
                    "duplex": {},
                    "server": {
                      "web": {
                        "inherited": false,
                        "port": 8080,
                        "portnum": 1,
                        "protocol": "http"
                      }
                    }
                  }
                },
                "ref": {
                  "domain": "kumori.examples",
                  "kind": "component",
                  "module": "calccache",
                  "name": "codeserver",
                  "version": [
                    3,
                    0,
                    7
                  ]
                },
                "spec": [
                  1,
                  0
                ]
              },
              "config": {
                "resilience": 0,
                "resource": {},
                "scale": {
                  "hsize": 1
                }
              },
              "name": "codeserver"
            },
            "kafka": {
              "artifact": {
                "description": {
                  "builtin": false,
                  "code": {
                    "kafka": {
                      "entrypoint": [
                        "/bin/cmd.sh"
                      ],
                      "image": {
                        "hub": {
                          "name": "",
                          "secret": ""
                        },
                        "tag": "bitnami/kafka"
                      },
                      "mapping": {
                        "env": {
                          "ALLOW_PLAINTEXT_LISTENER": {
                            "value": "yes"
                          },
                          "CMD_ORIGINAL": {
                            "value": "/opt/bitnami/scripts/kafka/run.sh"
                          },
                          "ENTRY_ORIGINAL": {
                            "value": "/opt/bitnami/scripts/kafka/entrypoint.sh"
                          },
                          "KAFKA_CFG_LISTENERS": {
                            "value": "PLAINTEXT://:9092"
                          },
                          "KAFKA_CFG_NUM_PARTITIONS": {
                            "value": "10"
                          },
                          "KAFKA_CFG_ZOOKEEPER_CONNECT": {
                            "value": "0.zookeeperclient:2181"
                          }
                        },
                        "filesystem": {
                          "/bin/cmd.sh": {
                            "data": {
                              "value": "    #!/bin/bash\n    TMP=`getent ahostsv4 $HOSTNAME | grep  $HOSTNAME`\n    SELF=${TMP%% *}\n    export KAFKA_CFG_ADVERTISED_LISTENERS=PLAINTEXT://$SELF:9092\n    echo $ENTRY_ORIGINAL $CMD_ORIGINAL\n    exec $ENTRY_ORIGINAL $CMD_ORIGINAL"
                            },
                            "format": "text",
                            "mode": 493,
                            "path": "/bin/cmd.sh",
                            "rebootOnUpdate": false
                          },
                          "/bitnami": {
                            "path": "/bitnami",
                            "volume": "kafkavolume"
                          }
                        }
                      },
                      "name": "kafka",
                      "size": {
                        "cpu": {
                          "kind": "cpu",
                          "size": 2000,
                          "unit": "m"
                        },
                        "memory": {
                          "kind": "ram",
                          "size": 4,
                          "unit": "G"
                        },
                        "mincpu": 1000
                      }
                    }
                  },
                  "config": {
                    "parameter": {},
                    "resilience": 0,
                    "resource": {
                      "kafkavolume": {
                        "volume": {
                          "kind": "storage",
                          "size": 10,
                          "unit": "G"
                        }
                      }
                    },
                    "scale": {
                      "hsize": 1
                    }
                  },
                  "probe": {},
                  "profile": {
                    "iopsintensive": false,
                    "threadability": "*"
                  },
                  "size": {
                    "bandwidth": {
                      "kind": "bandwidth",
                      "size": 1000,
                      "unit": "M"
                    },
                    "minbandwidth": 1000,
                    "mincpu": {
                      "kind": "cpu",
                      "size": 1000,
                      "unit": "m"
                    }
                  },
                  "srv": {
                    "client": {
                      "zookeeperclient": {
                        "inherited": false,
                        "protocol": "http"
                      }
                    },
                    "duplex": {
                      "internal": {
                        "inherited": false,
                        "port": 29092,
                        "portnum": 1,
                        "protocol": "http"
                      }
                    },
                    "server": {
                      "advertised": {
                        "inherited": false,
                        "port": 9092,
                        "portnum": 1,
                        "protocol": "http"
                      }
                    }
                  }
                },
                "ref": {
                  "domain": "kumori.examples",
                  "kind": "component",
                  "module": "calccache",
                  "name": "kafka",
                  "version": [
                    3,
                    0,
                    7
                  ]
                },
                "spec": [
                  1,
                  0
                ]
              },
              "config": {
                "resilience": 0,
                "resource": {
                  "kafkavolume": {
                    "volume": {
                      "kind": "storage",
                      "size": 10,
                      "unit": "G"
                    }
                  }
                },
                "scale": {
                  "hsize": 1
                }
              },
              "name": "kafka"
            },
            "zookeeper": {
              "artifact": {
                "description": {
                  "builtin": false,
                  "code": {
                    "zookeeper": {
                      "image": {
                        "hub": {
                          "name": "",
                          "secret": ""
                        },
                        "tag": "bitnami/zookeeper"
                      },
                      "mapping": {
                        "env": {
                          "ALLOW_ANONYMOUS_LOGIN": {
                            "value": "yes"
                          },
                          "ZOO_PORT_NUMBER": {
                            "value": "2181"
                          },
                          "ZOO_TIC_TIME": {
                            "value": "2000"
                          }
                        },
                        "filesystem": {
                          "/bitnami": {
                            "path": "/bitnami",
                            "volume": "zookeepervolume"
                          }
                        }
                      },
                      "name": "zookeeper",
                      "size": {
                        "cpu": {
                          "kind": "cpu",
                          "size": 2000,
                          "unit": "m"
                        },
                        "memory": {
                          "kind": "ram",
                          "size": 4,
                          "unit": "G"
                        },
                        "mincpu": 1000
                      },
                      "user": {
                        "groupid": 0,
                        "userid": 0
                      }
                    }
                  },
                  "config": {
                    "parameter": {},
                    "resilience": 0,
                    "resource": {
                      "zookeepervolume": {
                        "volume": {
                          "kind": "storage",
                          "size": 2,
                          "unit": "G"
                        }
                      }
                    },
                    "scale": {
                      "hsize": 1
                    }
                  },
                  "probe": {},
                  "profile": {
                    "iopsintensive": false,
                    "threadability": "*"
                  },
                  "size": {
                    "bandwidth": {
                      "kind": "bandwidth",
                      "size": 1000,
                      "unit": "M"
                    },
                    "minbandwidth": 1000,
                    "mincpu": {
                      "kind": "cpu",
                      "size": 1000,
                      "unit": "m"
                    }
                  },
                  "srv": {
                    "client": {},
                    "duplex": {},
                    "server": {
                      "zookeepermain": {
                        "inherited": false,
                        "port": 2181,
                        "portnum": 1,
                        "protocol": "http"
                      }
                    }
                  }
                },
                "ref": {
                  "domain": "kumori.examples",
                  "kind": "component",
                  "module": "calccache",
                  "name": "zookeeper",
                  "version": [
                    3,
                    0,
                    7
                  ]
                },
                "spec": [
                  1,
                  0
                ]
              },
              "config": {
                "resilience": 0,
                "resource": {
                  "zookeepervolume": {
                    "volume": {
                      "kind": "storage",
                      "size": 2,
                      "unit": "G"
                    }
                  }
                },
                "scale": {
                  "hsize": 1
                }
              },
              "name": "zookeeper"
            }
          },
          "srv": {
            "client": {},
            "duplex": {},
            "server": {
              "csinbound.inbound": {
                "inherited": true,
                "protocol": "http"
              },
              "discover": {
                "inherited": false,
                "port": 9092,
                "portnum": 1,
                "protocol": "tcp"
              }
            }
          }
        },
        "ref": {
          "domain": "kumori.examples",
          "kind": "service",
          "module": "calccache",
          "name": "service_kafka",
          "version": [
            3,
            0,
            7
          ]
        },
        "spec": [
          1,
          0
        ]
      },
      "config": {
        "parameter": {},
        "resilience": 0,
        "resource": {
          "cert": {
            "certificate": "cluster.core/wildcard-vera-kumori-cloud"
          },
          "domain": {
            "domain": "vscode"
          },
          "kafkavolume": {
            "volume": {
              "kind": "storage",
              "size": 10,
              "unit": "G"
            }
          },
          "zookeepervolume": {
            "volume": {
              "kind": "storage",
              "size": 2,
              "unit": "G"
            }
          }
        },
        "scale": {
          "detail": {
            "codeserver": {
              "hsize": 1
            },
            "kafka": {
              "hsize": 1
            },
            "zookeeper": {
              "hsize": 1
            }
          }
        }
      },
      "meta": {},
      "name": "kafkacodetest",
      "up": null
    },
    "kafkacodetest.csinbound": {
      "artifact": {
        "description": {
          "builtin": true,
          "config": {
            "parameter": {
              "clientcert": false,
              "type": "https",
              "websocket": true
            },
            "resilience": 0,
            "resource": {
              "servercert": {
                "certificate": "cluster.core/wildcard-vera-kumori-cloud"
              },
              "serverdomain": {
                "domain": "vscode"
              }
            },
            "scale": {}
          },
          "srv": {
            "client": {
              "inbound": {
                "inherited": false,
                "protocol": "http"
              }
            },
            "duplex": {},
            "server": {}
          }
        },
        "ref": {
          "domain": "kumori.systems",
          "kind": "service",
          "module": "builtins/inbound",
          "name": "inbound",
          "version": [
            1,
            1,
            0
          ]
        },
        "spec": [
          1,
          0
        ]
      },
      "config": {
        "parameter": {},
        "resilience": 0,
        "resource": {
          "servercert": {
            "certificate": "cluster.core/wildcard-vera-kumori-cloud"
          },
          "serverdomain": {
            "domain": "vscode"
          }
        },
        "scale": {}
      },
      "meta": {},
      "name": "kafkacodetest.csinbound",
      "up": "kafkacodetest"
    }
  },
  "links": [
    {
      "meta": {
        "meta": {}
      },
      "s_c": "inbound",
      "s_d": "kafkacodetest.csinbound",
      "t_c": "csinbound.inbound",
      "t_d": "kafkacodetest"
    }
  ],
  "ref": {
    "domain": "mmoroni",
    "kind": "solution",
    "name": "kafkacodetest"
  },
  "top": "kafkacodetest"
}